



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Workshop and lab content for Amazon Aurora PostgreSQL compatible databases. This code will contain a series of templates, instructional guides and sample code to educate users on how to use Amazon Aurora features.">
      
      
        <link rel="canonical" href="https://awsauroralabsmysql.com/modules/create/">
      
      
        <meta name="author" content="amazon-aurora-labs-for-mysql@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.1">
    
    
      
        <title>Creating a New Aurora Cluster - Amazon Aurora Labs for PostgreSQL</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../assets/css/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#creating-a-new-aurora-cluster" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">

        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>

        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>

        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  Amazon Aurora Labs for PostgreSQL
                </span>
                <span class="md-header-nav__topic">
                  Creating a New Aurora Cluster
                </span>
              
            
          </div>
        </div>

        <!-- Button to open search dialogue -->
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>

              <!-- Search interface -->
              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>

        <!-- Repository containing source -->
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  <li class="md-tabs__item">
    
      <a href="../" class="md-tabs__link">
        Getting Started
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../prerequisites/" class="md-tabs__link md-tabs__link--active">
          Modules
        </a>
      
    </li>
  

      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://awsauroralabsmysql.com" title="Amazon Aurora Labs for PostgreSQL" class="md-nav__button md-logo">
      
        <img src="../../assets/images/aws_smile_logo.png" width="48" height="48">
      
    </a>
    Amazon Aurora Labs for PostgreSQL
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Creating a New Aurora Cluster
      </label>
    
    <a href="./" title="Creating a New Aurora Cluster" class="md-nav__link md-nav__link--active">
      Creating a New Aurora Cluster
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-creating-the-db-cluster" class="md-nav__link">
    1. Creating the DB cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-retrieving-the-db-cluster-endpoints" class="md-nav__link">
    2. Retrieving the DB cluster endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-assigning-an-iam-role-to-the-db-cluster" class="md-nav__link">
    3. Assigning an IAM role to the DB cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-creating-a-replica-auto-scaling-policy" class="md-nav__link">
    4. Creating a replica auto scaling policy
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect/index.md" title="Connecting, Loading Data and Auto Scaling" class="md-nav__link">
      Connecting, Loading Data and Auto Scaling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect/index.md" title="Backup And Restore" class="md-nav__link">
      Backup And Restore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../clone/index.md" title="Fast Cloning" class="md-nav__link">
      Fast Cloning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backtrack/index.md" title="Backtracking a Cluster" class="md-nav__link">
      Backtracking a Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../perf-insights/" title="Using Performance Insights" class="md-nav__link">
      Using Performance Insights
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../perf-insights/" title="PostgreSQL Performance Benchmarking" class="md-nav__link">
      PostgreSQL Performance Benchmarking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../create-serverless/index.md" title="Creating a Serverless Aurora Cluster" class="md-nav__link">
      Creating a Serverless Aurora Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Using Aurora Serverless with Lambda Functions" class="md-nav__link">
      Using Aurora Serverless with Lambda Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Query Plan Management" class="md-nav__link">
      Query Plan Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Cluster Cache Management" class="md-nav__link">
      Cluster Cache Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Oracle to Aurora PostgreSQL migration using DMS and SCT" class="md-nav__link">
      Oracle to Aurora PostgreSQL migration using DMS and SCT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Database Activity Streaming" class="md-nav__link">
      Database Activity Streaming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Major Version Upgrad" class="md-nav__link">
      Major Version Upgrad
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Cross region replication using DMS/logical replication" class="md-nav__link">
      Cross region replication using DMS/logical replication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Outbound Logical Replication" class="md-nav__link">
      Outbound Logical Replication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Kerberos/AD authentication" class="md-nav__link">
      Kerberos/AD authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Global Database" class="md-nav__link">
      Global Database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Amazon Aurora AI/ML Integration" class="md-nav__link">
      Amazon Aurora AI/ML Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Amazon Aurora Export to S3" class="md-nav__link">
      Amazon Aurora Export to S3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Aurora Postgres Transportable Database" class="md-nav__link">
      Aurora Postgres Transportable Database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../connect-serverless/index.md" title="Rialto GA" class="md-nav__link">
      Rialto GA
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contribute/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-creating-the-db-cluster" class="md-nav__link">
    1. Creating the DB cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-retrieving-the-db-cluster-endpoints" class="md-nav__link">
    2. Retrieving the DB cluster endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-assigning-an-iam-role-to-the-db-cluster" class="md-nav__link">
    3. Assigning an IAM role to the DB cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-creating-a-replica-auto-scaling-policy" class="md-nav__link">
    4. Creating a replica auto scaling policy
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="creating-a-new-aurora-cluster">Creating a New Aurora Cluster<a class="headerlink" href="#creating-a-new-aurora-cluster" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are familiar with the basic concepts of Amazon Aurora MySQL, and have created a cluster in the past, you may skip this module, by using provisioning the lab environment using the <a href="https://[[website]]/templates/lab-with-cluster.yml"><strong>lab-with-cluster.yml</strong></a> CloudFormation template, so the DB cluster is provisioned for you. Skip to <a href="/modules/connect/">Connecting, Loading Data and Auto Scaling</a>.</p>
</div>
<p>This lab will walk you through the steps of creating an Amazon Aurora database cluster manually, and configuring app the parameters required for the cluster components. At the end of this lab you will have a database cluster ready to be used in subsequent labs.</p>
<p>This lab contains the following tasks:</p>
<ol>
<li>Creating the DB cluster</li>
<li>Retrieving the DB cluster endpoints</li>
<li>Assigning an IAM role to the DB cluster</li>
<li>Creating a replica auto scaling policy</li>
</ol>
<p>This lab requires the following lab modules to be completed first:</p>
<ul>
<li><a href="/modules/prerequisites/">Prerequisites</a> (using <code>lab-no-cluster.yml</code> template is sufficient)</li>
</ul>
<h2 id="1-creating-the-db-cluster">1. Creating the DB cluster<a class="headerlink" href="#1-creating-the-db-cluster" title="Permanent link">&para;</a></h2>
<p>Open the <a href="https://us-west-2.console.aws.amazon.com/rds/home?region=us-west-2" target="_blank">Amazon RDS service console</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Region Check</p>
<p>Ensure you are still working in the correct region, especially if you are following the links above to open the service console at the right screen.</p>
</div>
<p>Click <strong>Create database</strong> to start the configuration process</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The RDS console database creation workflow has been simplified recently. Depending on your previous usage of the RDS console UI, you may see the old workflow or the new one, you may also be presented with a prompt to toggle between them. In this lab we are using the new workflow for reference, although the steps will work similarly in the old console workflow as well, if you are more familiar with it.</p>
</div>
<p><span class="image"><img alt="Create Database" src="1-create-database.png?raw=true" /></span></p>
<p>In the first configuration section of the <strong>Create database</strong> page, called <strong>Database settings</strong> ensure the <strong>Easy create</strong> toggle button is turned <strong>OFF</strong> (grey color).</p>
<p>Next, in the <strong>Engine options</strong> section, choose the <strong>Amazon Aurora</strong> engine type, the <strong>Amazon Aurora with MySQL compatibility</strong> edition, the <strong>Aurora (MySQL 5.6) 1.19.2</strong> version and the <strong>Regional</strong> database location.</p>
<p><span class="image"><img alt="Engine Options" src="1-engine-options.png?raw=true" /></span></p>
<p>In the <strong>Database features</strong> section, select <strong>One writer and multiple readers</strong>, and in the <strong>Templates</strong> section, select <strong>Production</strong>. The selections so far will instruct AWS to create an Aurora MySQL database cluster with the most recent version of the MySQL 5.6 compatible engine in a highly available configuration with one writer and one reader database instance in the cluster.</p>
<p>In the <strong>Settings</strong> section give your database cluster a recognizable identifier, such as <code>labstack-cluster</code>. Configure the name and password of the master database user, with the most elevated permissions in the database. We recommend to use the user name <code>masteruser</code> for consistency with subsequent labs and a password of your choosing. For simplicity ensure the check box <strong>Auto generate a password</strong> is <strong>not checked</strong>.</p>
<p><span class="image"><img alt="Database Settings" src="1-db-settings.png?raw=true" /></span></p>
<p>In the <strong>Connectivity</strong> section, expand the sub-section called <strong>Additional connectivity configuration</strong>. This section allows you to specify where the database cluster will be deployed within your defined network configuration. To simplify the labs, the CloudFormation stack you deployed in the preceding <a href="/modules/prerequisites/">Prerequisites</a> module, has configured a VPC that includes all resources needed for an Aurora database cluster. This includes the VPC itself, subnets, DB subnet groups, security groups and several other networking constructs. All you need to do is select the appropriate existing connectivity controls in this section.</p>
<p>Pick the <strong>Virtual Private Cloud (VPC)</strong> named after the CloudFormation stack name, such as <code>labstack-vpc</code>. Similarly make sure the selected <strong>Subnet Group</strong> also matches the stack name (e.g. <code>labstack-dbsubnets-[hash]</code>). Make sure the cluster <strong>Publicly accessible</strong> option is set to <strong>No</strong>. The lab environment also configured a <strong>VPC security group</strong> that allows your lab workspace EC2 instance to connect to the database. Make sure the <strong>Choose existing</strong> security group option is selected and from the dropdown pick the security group with a name ending in <code>-mysql-internal</code> (eg. <code>labstack-mysql-internal</code>). Please remove any other security groups, such as <code>default</code> from the selection.</p>
<p><span class="image"><img alt="Connectivity" src="1-connectivity.png?raw=true" /></span></p>
<p>Next, expand the <strong>Advanced configuration</strong> section. Set the <strong>Initial database name</strong> to <code>mylab</code>. For the <strong>DB cluster parameter group</strong> and <strong>DB parameter group</strong> selectors, choose the groups with the stack name in their name (e.g. <code>labstack-[...]</code>). Choose a <code>7 days</code> <strong>Backup retention period</strong>. Check the box to <strong>Enable encryption</strong> and select the <code>[default] aws/rds</code> for the <strong>Master key</strong>.</p>
<p><span class="image"><img alt="Advanced configuration" src="1-advanced-1.png?raw=true" /></span></p>
<p>Enable the backtrack capability by checking the <strong>Enable Backtrack</strong> box and set a <strong>Target backtrack window</strong> of <code>24</code> hours. Check the box to <strong>Enable Performance Insights</strong> with a <strong>Retention period of <code>Default (7 days)</code> and use the <code>[default] aws/rds</code> </strong>Master key<strong> for monitoring data encryption. Next, check the </strong>Enable Enhanced Monitoring<strong> box, and select a </strong>Granularity<strong> of <code>1 second</code>. For </strong>Log exports<strong> check the </strong>Error log<strong> and </strong>Slow query log** boxes.</p>
<p><span class="image"><img alt="Advanced configuration" src="1-advanced-2.png?raw=true" /></span></p>
<p>Also in the <strong>Advanced configuration</strong> section, de-select the check box <strong>Enable delete protection</strong>. In a production use case, you will want to leave that option checked, but for testing purposes, un-checking this option will make it easier to clean up the resources once you have completed the labs.</p>
<p>Before continuing, let's summarize the configuration options selected. You will create a database cluster with the following characteristics:</p>
<ul>
<li>Aurora MySQL 5.6 compatible (latest stable engine version)</li>
<li>Regional cluster composed of a writer and a reader DB instance in different availability zones (highly available)</li>
<li>Deployed in the VPC and using the network configuration of the lab environment</li>
<li>Using custom database engine parameters that enable the slow query log, S3 access and tune a few other configurations</li>
<li>Automatically backed up continuously, retaining backups for 7 days</li>
<li>Using data at rest encryption</li>
<li>Retaining 24 hours worth of change data for backtrack purposes</li>
<li>With Enhanced Monitoring and Performance Insights enabled</li>
</ul>
<p>Click <strong>Create database</strong> to provision the DB cluster.</p>
<p><span class="image"><img alt="Advanced configuration - end" src="1-advanced-3.png?raw=true" /></span></p>
<h2 id="2-retrieving-the-db-cluster-endpoints">2. Retrieving the DB cluster endpoints<a class="headerlink" href="#2-retrieving-the-db-cluster-endpoints" title="Permanent link">&para;</a></h2>
<p>The database cluster may take several minutes to provision, including the DB instances making up the cluster. In order to connect to the DB cluster and start using it in subsequent labs, you need to retrieve the DB cluster endpoints. There are two endpoints created by default. The <strong>Cluster Endpoint</strong> will always point to the <strong>writer</strong> DB instance of the cluster, and should be used for both writes and reads. The <strong>Reader Endpoint</strong> will always resolve to one of the <strong>
reader</strong> DB instances and should be used to offload read operations to read replicas. In the RDS console, go to the DB cluster detail view by clicking on the cluster DB identifier.</p>
<p><span class="image"><img alt="DB Cluster Status" src="2-db-cluster-status.png?raw=true" /></span></p>
<p>The <strong>Endpoints</strong> section in the <strong>Connectivity and security</strong> tab of the details page displays the endpoints. Note these values down, as you will use them later.</p>
<p><span class="image"><img alt="DB Cluster Endpoints" src="2-db-cluster-details.png?raw=true" /></span></p>
<h2 id="3-assigning-an-iam-role-to-the-db-cluster">3. Assigning an IAM role to the DB cluster<a class="headerlink" href="#3-assigning-an-iam-role-to-the-db-cluster" title="Permanent link">&para;</a></h2>
<p>Once created, you should assign an IAM role to the DB cluster, in order to allow the cluster access to Amazon S3 for importing and exporting data. The IAM role has already been created using CloudFormation when you created the lab environment. On the same DB cluster detail page as before, in the <strong>Manage IAM roles</strong> section, choose the IAM role named after the stack name, ending in <code>-integrate-[region]</code> (e.g. <code>labstack-integrate-[region]</code>). Then click <strong>Add role</strong>.</p>
<p><span class="image"><img alt="DB Cluster Add Role" src="3-add-role.png?raw=true" /></span></p>
<p>Once the operation completes the <strong>Status</strong> of the role will change from <code>Pending</code> to <code>Active</code>.</p>
<h2 id="4-creating-a-replica-auto-scaling-policy">4. Creating a replica auto scaling policy<a class="headerlink" href="#4-creating-a-replica-auto-scaling-policy" title="Permanent link">&para;</a></h2>
<p>Finally, you will add a read replica auto scaling configuration to the DB cluster. This will allow the DB cluster to scale the number of reader DB instances that operate in the DB cluster at any given point in time based on the load.</p>
<p>In the top right corner of the details page, click on <strong>Actions</strong> and then on <strong>Add replica auto scaling</strong>.</p>
<p><span class="image"><img alt="DB Cluster Add Auto Scaling" src="4-add-as-policy.png?raw=true" /></span></p>
<p>Provide a <strong>Policy name</strong> based on the stack name, such as <code>labstack-autoscale-readers</code>. For the <strong>Target metric</strong> choose <strong>Average CPU utilization of Aurora Replicas</strong>. Enter a <strong>Target value</strong> of <code>20</code> percent. In a production use case this value may need to be set much higher, but we are using a lower value for demonstration purposes. Next, expand the <strong>Additional configuration</strong> section, and change both the <strong>Scale in cooldown period</strong> and <strong>Scale out cooldown period</strong> to a value of <code>180</code> seconds. This will reduce the time you have to wait between scaling operations in subsequent labs.</p>
<p>In the <strong>Cluster capacity details</strong> section, set the <strong>Minimum capacity</strong> to <code>1</code> and <strong>Maximum capacity</strong> to <code>2</code>. In a production use case you may need to use different values, but for demonstration purposes, and to limit the cost of associated with the labs we limit the number of readers to two. Next click <strong>Add policy</strong>.</p>
<p><span class="image"><img alt="Auto Scaling Configuration" src="4-as-policy-config.png?raw=true" /></span></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../prerequisites/" title="Prerequisites" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Prerequisites
              </span>
            </div>
          </a>
        
        
          <a href="../perf-insights/" title="Using Performance Insights" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Using Performance Insights
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://awsauroralabsmysql.com" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/rds/aurora/details/mysql-details/" class="md-footer-social__link fa fa-amazon"></a>
    
      <a href="https://github.com/aws-samples/amazon-aurora-labs-for-mysql" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8e03edeb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>